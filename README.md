# 한국 주식시장 거래량 폭발 임계치 백테스팅 프로젝트

고도로 정교한 한국 주식시장 거래량 기반 트레이딩 신호 백테스팅 시스템

[![Python](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![Status](https://img.shields.io/badge/status-Phase%203%20Complete-success.svg)](https://github.com/VolumeQuant/volume-breakout-backtest)

---

## 📊 프로젝트 개요

한국 주식시장(KOSPI, KOSDAQ)에서 **거래량 폭발 신호**와 **투자자 수급 데이터**를 결합하여 최적의 진입 타이밍을 찾는 백테스팅 시스템입니다.

### 핵심 질문
> **"거래량이 갑자기 급증할 때, 그 이후 주가는 어떻게 움직이는가?"**
> **"금융투자, 연기금, 개인 투자자의 수급이 수익률에 영향을 미치는가?"**

---

## 🎯 프로젝트 규모

- **파일 수**: 45개 Python 파일
- **프로젝트 크기**: 12MB
- **개발 단계**: Phase 3 완료
- **데이터 기간**: 2022년 1월 ~ 2024년 12월 (3년)
- **대상 종목**: KOSPI 상위 200개 + KOSDAQ 상위 150개

---

## 🚀 핵심 전략: 거래량 폭발 임계치

### 기본 원리

두 가지 거래량 지표를 조합하여 진입 신호를 생성합니다:

#### 1. Volume Ratio (거래량 비율)
```python
Volume_Ratio = 당일 거래량 / 20일 이동평균
테스트 값: 2.0, 3.0, 4.0, 5.0, 6.5배
```

#### 2. Z-Score (거래량 표준편차)
```python
Z_Score = (당일 거래량 - 60일 평균) / 60일 표준편차
테스트 값: 1.5, 2.0, 2.5, 3.0
```

#### 3. 가격 상승률 필터 (Phase 2 추가)
```python
Price_Change = 당일 가격 상승률
테스트 값: 0%, 1%, 2%, ... 15%
```

### 그리드 서치 최적화

- **기본 조합**: VR × ZS = 4 × 4 = 16개 조합
- **가격 필터 추가**: 16 × 16 = 256개 조합
- **홀딩 기간**: 1일, 3일, 5일, 10일

### 최고 성과 (Phase 2 기준)

| 파라미터 | 값 | 성과 |
|---------|-----|------|
| **Volume Ratio** | ≥ 6.5 | 월 평균 13.1건 |
| **Z-Score** | ≥ 3.0 | 승률 향상 |
| **가격 상승률** | ≥ 10% | 10일 수익률 3~5% |

---

## 📈 개발 단계별 진화

### Phase 1: 기본 거래량-가격 필터

**주요 파일**:
- `p1_01_vol_price_filter.py` - VR + ZS 기반 신호 생성
- `p1_02_single_investor_flow.py` - 투자자별 수급 분석 (금융투자/연기금/개인)

**발견**:
- 순수 거래량 신호만으로는 제한적
- 투자자 수급 데이터 통합 필요

### Phase 2: 다차원 그리드 서치

**주요 파일**:
- `p1_03_grid_search.py` - 파라미터 최적화
- `p1_04_price_filter_grid.py` - 가격 필터 추가

**발견**:
- 가격 상승률 필터 추가 시 성과 크게 개선
- VR ≥ 6.5, ZS ≥ 3.0 조합이 최적

### Phase 3: 종합 검증 및 실전 전략 (완료) ✅

**주요 파일**:
- `p1_06_oos_validation_2025.py` - 2025년 OOS(Out-of-Sample) 검증
- `p1_07_realistic_strategy.py` - 실전 가능한 전략 개발
- `p1_08_experimental_filters.py` - 고급 필터 실험

**결론**:
> "거래량+가격 신호는 단기 모멘텀 포착에 유효하나, 투자자 수급과 결합 시 더 높은 예측력 확보"

**최종 커밋**: "Phase 3 완료: 거래량+가격 전략의 한계 확인 및 종합 보고서 작성"

---

## 💼 투자자별 수급 분석

### 데이터 소스
- **라이브러리**: pykrx (한국거래소 공식 API)
- **투자자 유형**: 금융투자, 연기금, 개인, 외국인
- **지표**: 일별 순매수/순매도 금액

### 분석 결과

| 투자자 유형 | 신호 | 영향 |
|-----------|------|------|
| **금융투자** | 순매수 ↑ | 단기 긍정적 |
| **연기금** | 선회매도 | 주의 필요 |
| **개인** | 과매수 | "개미 털기" 리스크 |

---

## 📁 프로젝트 구조

```
volume-breakout-backtest/
├── Phase 1 - 기본 필터
│   ├── p1_01_vol_price_filter.py
│   ├── p1_02_single_investor_flow.py
│   └── p1_03_grid_search.py
│
├── Phase 2 - 고급 그리드 서치
│   ├── p1_04_price_filter_grid.py
│   └── p1_05_multi_dim_search.py
│
├── Phase 3 - 검증 및 실전
│   ├── p1_06_oos_validation_2025.py
│   ├── p1_07_realistic_strategy.py
│   └── p1_08_experimental_filters.py
│
├── 데이터 모듈
│   ├── data_loader.py           # 주가 데이터 로딩
│   └── flow_data_loader.py      # 투자자 수급 데이터
│
├── 분석 유틸리티
│   ├── indicators.py            # 지표 계산
│   ├── backtest.py              # 백테스팅 엔진
│   └── visualizer.py            # 결과 시각화
│
└── results/                      # 백테스트 결과 (CSV, PNG)
```

---

## 🔧 기술적 특징

### 데이터 처리
- 60일 미만 데이터 제외
- 거래정지일 자동 제외
- 거래량 0인 날 필터링
- 신호별 상세 데이터 추출

### 백테스팅 엔진
- 홀딩 기간별 수익률 계산 (1일, 3일, 5일, 10일)
- 승률, 손익비, 샤프지수 계산
- 최대낙폭(MDD) 측정

### 시각화
- 히트맵: 조합별 평균 수익률
- 박스플롯: 수익률 분포
- 막대 그래프: 신호 발생 빈도

---

## ⚙️ 설치 및 실행

### 1. 라이브러리 설치
```bash
pip install -r requirements.txt
```

주요 패키지:
- `pykrx` - 한국거래소 API
- `pandas` - 데이터 처리
- `numpy` - 수치 계산
- `matplotlib` / `seaborn` - 시각화

### 2. 데이터 수집
```bash
python data_loader.py
```

### 3. Phase별 실행

#### Phase 1: 기본 분석
```bash
python p1_01_vol_price_filter.py
python p1_02_single_investor_flow.py
```

#### Phase 2: 그리드 서치
```bash
python p1_04_price_filter_grid.py
```

#### Phase 3: 실전 전략
```bash
python p1_07_realistic_strategy.py
```

---

## 📊 결과 해석

### 신호 발생 빈도
- **높은 임계치 (VR≥6.5, ZS≥3.0)**: 월 13건 (드물지만 강력)
- **낮은 임계치 (VR≥2.0, ZS≥1.5)**: 월 100건+ (빈번하지만 약함)

### 수익률 분포
- **평균 수익률**: 1~5% (10일 기준)
- **승률**: 50~60%
- **손익비**: 1.2~1.5

### 최적 전략 (Phase 3)
```python
VR ≥ 6.5
ZS ≥ 3.0
가격 상승률 ≥ 10%
홀딩 기간 = 10일
+ 금융투자 순매수 확인
```

---

## 🧪 주요 발견 사항

### ✅ 유효한 신호
1. **극단적 거래량 급증** (VR ≥ 6.5)
2. **당일 강한 가격 상승** (≥ 10%)
3. **금융투자 순매수 동반**

### ⚠️ 주의 사항
1. **연기금 선회매도** 시 수익률 저하
2. **개인 과매수** 이후 조정 가능성
3. **단기 신호의 한계** - 중장기 펀더멘탈 필수

### ❌ 효과 없는 조합
- VR < 2.0 (거래량 증가 불충분)
- 가격 하락 또는 횡보 시 진입
- 개인투자자 단독 순매수

---

## 🎯 실전 활용 가이드

### 신호 확인 순서
1. **거래량 체크**: VR ≥ 6.5, ZS ≥ 3.0
2. **가격 확인**: 당일 +10% 이상 상승
3. **수급 확인**: 금융투자 순매수 여부
4. **진입 결정**: 3가지 조건 모두 만족 시

### 포지션 관리
- **진입**: T+1일 시초가
- **홀딩**: 10일 (최적 기간)
- **손절**: -5% (선택)
- **분산**: 최소 5개 종목

---

## 📚 관련 문서

- `docs/phase1_report.md` - Phase 1 결과 리포트
- `docs/phase2_grid_search.md` - 그리드 서치 상세
- `docs/phase3_final_report.md` - 최종 종합 리포트

---

## ⚖️ 면책 조항

본 프로젝트는 **연구 및 교육 목적**으로 제공됩니다.
- 과거 성과가 미래를 보장하지 않습니다
- 투자 권유가 아니며, 투자 책임은 본인에게 있습니다
- 실전 적용 전 충분한 검증을 권장합니다

---

## 🤝 기여

이슈 및 풀 리퀘스트 환영합니다!

---

## 📄 라이선스

MIT License

---

**작성일**: 2026-01-30
**버전**: Phase 3 Complete
**Python**: 3.8+

Made with 📊 by VolumeQuant Team
